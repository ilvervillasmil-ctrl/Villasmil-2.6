from villasmil_omega.core import (
    run_core,
    indice_mc,
    indice_ci,
    actualizar_L2,
    penalizar_MC_CI,
)


def test_run_core_executes_without_error(capsys):
    run_core()
    captured = capsys.readouterr()
    assert "Villasmil-Î© v2.6 Core Module" in captured.out


def test_indice_mc_non_trivial_case():
    score = indice_mc(aciertos=3, errores=1)
    assert 0 < score <= 1
    assert score == 3 / 4


def test_indice_ci_non_trivial_case():
    score = indice_ci(aciertos=4, errores=1, ruido=1)
    assert 0 < score <= 1


def test_actualizar_L2_moves_towards_optimum():
    L2_nuevo = actualizar_L2(L2_actual=0.5, k=0.25, L2_opt=0.125)
    assert L2_nuevo < 0.5


def test_penalizar_MC_CI_applies_penalty():
    MC_pen, CI_pen = penalizar_MC_CI(MC=1.0, CI=1.0, L2=0.5, L2_opt=0.125)
    assert MC_pen < 1.0
    assert CI_pen < 1.0

